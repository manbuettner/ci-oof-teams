{"version":3,"sources":["components/Privacy.js","components/TermsOfUse.js","hoc/Auxillary/Auxillary.js","components/UserInformation/UserInformation.js","classes/CIUser.js","components/DeputyInformation/DeputysInformationList/DeputysInformationList.js","components/DeputyInformation/DeputyInformation.js","components/AbsencePeriod/AbsencePeriod.js","components/AbsenceReason/AbsenceReason.js","components/OoFTeams.js","components/ConsentPopup.js","components/ClosePopup.js","components/App.js","index.js","components/AbsencePeriod/AbsencePeriod.module.css"],"names":["Privacy","React","Component","TermsOfUse","aux","props","children","UserInformation","Label","givenName","sn","email","ChoiceGroup","options","oofStatus","onChange","onChangeStatus","CIUser","data","this","title","telephoneNumber","login","DelegatesInformationList","allDeputys","delegateUser","i","length","push","key","name","surname","mail","businessTele","businessPhones","deputyList","DetailsList","items","columns","className","fieldName","minWidth","maxWidth","onColumnClick","isResizable","isSorted","setKey","layoutMode","DetailsListLayoutMode","justified","selectionPreservedOnEmptyClick","onItemInvoked","item","deputyFound","selectionMode","SelectionMode","single","DeputyInformation","deputyPanelHandler","setState","prevState","isDeputyPanelOpen","searchFieldOnChangeHandler","event","deputyName","state","target","value","deputySearchHandler","searchParameter","a","updatedDeputy","deputyContent","graphRequestParams","method","headers","graphAccessToken","fetch","catch","unhandledFetchError","responseDeputy","json","dataDeputy","ok","deputyUser","finishedLoadingDeputy","console","log","error","deputyTextfieldReadOnlyHandler","deputy","deputyHandler","bind","selectDeputyDescription","TextField","readyOnly","disabled","DefaultButton","text","showDeputyButton","onClick","Panel","isOpen","onDismiss","type","PanelType","medium","closeButtonAriaLabel","Stack","horizontal","tokens","aligmentsStackTokenSearch","PrimaryButton","childrenGap","padding","aligmentsStackFromTokens","aligmentsStackToTokens","aligmentsStackLabelTokens","AbsencePeriod","useState","fromDate","setFromDate","toDate","setToDate","Boolean","scheduledOOF","setScheduledOOF","DayPickerString","months","shortMonths","days","shortDays","goToToday","prevMonthAriaLabel","nextMonthAriaLabel","prevYearAriaLabel","nextYearAriaLabel","monthPickerHeaderAriaLabel","yearPickerHeaderAriaLabel","Text","Checkbox","label","checked","ev","DatePicker","id","classes","Control","firstDayOfWeek","DayOfWeek","Monday","string","showWeekNumbers","firstWeekOfYear","showMonthPickerAsOverlay","isRequired","placeholder","ariaLabel","onSelectDate","fromDateHandler","defaultValue","moment","showSecond","minuteStep","time","fromTimeHandler","_d","style","paddingLeft","toDateHandler","toTimeHandler","AbsenceReason","Dropdown","OoFTeams","ssoLoginSuccess","token","ssoToken","exchangeClientTokenForServerToken","ApiData","context","body","JSON","stringify","response","requestUserInformations","accessToken","upn","userContent","responseUser","dataUser","cCIUser","loggedInUser","callGraphFromClient","graphPhotoEndpoint","blob","imageBlog","photo","URL","createObjectURL","onChangeStatusHandler","isOutofOffice","fromTime","toTime","submitOOF","deputyFoundHandler","family_name","aadObjectId","submitButtonDisabled","consentRequired","consentProvided","ssoLoginFailure","consentSuccess","consentFailure","showConsentDialog","microsoftTeams","authenTokenRequestsOptions","successCallback","result","failureCallBack","getAuthToken","authenticate","url","window","location","origin","width","height","failureCallback","reason","Object","keys","Loader","serverExchangeMessage","userInformations","delegateInformations","absenceReason","submitButton","ConsentPopup","tenant","queryParams","client_id","process","response_type","scope","redirect_uri","nonce","crypto","randomBytes","toString","authorizeEndpoint","URLSearchParams","assign","ClosePopup","hashParams","getHashParameters","notifySuccess","notifyFailure","hash","substr","split","forEach","decodeURIComponent","initializeIcons","App","exact","path","component","ReactDOM","render","basename","Provider","theme","themes","teams","document","getElementById","module","exports"],"mappings":"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","file":"static/js/main.190cd095.chunk.js","sourcesContent":["// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n\r\nimport React from 'react';\r\n\r\n/**\r\n * This component is used to display the required\r\n * privacy statement which can be found in a link in the\r\n * about tab.\r\n */\r\nclass Privacy extends React.Component {\r\n    render() {\r\n      return (\r\n        <div>\r\n          <h1>Privacy Statement</h1>\r\n        </div>\r\n      );\r\n    }\r\n}\r\n\r\nexport default Privacy;","// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n\r\nimport React from 'react';\r\n\r\n/**\r\n * This component is used to display the required\r\n * terms of use statement which can be found in a\r\n * link in the about tab.\r\n */\r\nclass TermsOfUse extends React.Component {\r\n    render() {\r\n      return (\r\n        <div>\r\n          <h1>Terms of Use</h1>\r\n        </div>\r\n      );\r\n    }\r\n}\r\n\r\nexport default TermsOfUse;","const aux = (props) => props.children;\r\n\r\nexport default aux;","import React from 'react';\r\n// import classes from './UserInformation.module.css';\r\n\r\nimport Aux from '../../hoc/Auxillary/Auxillary';\r\nimport { Label } from '@fluentui/react';\r\nimport { ChoiceGroup } from '@fluentui/react';\r\n\r\nconst UserInformation = (props) => {    \r\n\r\n    return (\r\n        <Aux >\r\n            <div >\r\n                <Label>Current User</Label>\r\n            </div>\r\n            <div >\r\n                <Label>Information about current user</Label>\r\n            </div>\r\n            <div >\r\n                First name: <span><strong>{props.givenName}</strong></span>\r\n                <br />\r\n                Last name: <span><strong>{props.sn}</strong></span>\r\n                <br />\r\n                Email: <span><strong>{props.email}</strong></span>\r\n            </div>\r\n            <div>\r\n                <ChoiceGroup options={props.oofStatus} onChange={props.onChangeStatus}/>\r\n            </div>\r\n        </Aux>\r\n        \r\n\r\n    );\r\n}\r\n\r\nexport default UserInformation;","class CIUser {\r\n    constructor(data) {\r\n        \r\n        this.givenName = data[\"givenName\"];\r\n        this.sn = data[\"surname\"];\r\n        this.title = data[\"jobTitle\"];\r\n        this.email = data[\"mail\"];\r\n        this.telephoneNumber = \"\";\r\n\r\n        if(this.email !== null && this.email !== \"\" ) {\r\n            this.login = this.email;            \r\n        }\r\n    }\r\n\r\n    givenName() {\r\n        return this.givenName;\r\n    }\r\n\r\n    sn() {\r\n        return this.sn;\r\n    }\r\n\r\n    title() {\r\n        return this.title;\r\n    }\r\n\r\n    email() {\r\n        return this.email;\r\n    }\r\n\r\n    telephoneNumber() {\r\n        return this.telephoneNumber;\r\n    }\r\n\r\n    login() {\r\n        return this.login;\r\n    }\r\n}\r\n\r\n\r\nexport default CIUser;","import { DetailsList, DetailsListLayoutMode, PrimaryButton, SelectionMode } from '@fluentui/react';\r\nimport React from 'react';\r\nimport Aux from '../../../hoc/Auxillary/Auxillary';\r\n\r\n\r\n\r\nconst DelegatesInformationList = (props) => {\r\n\r\n    let allDeputys = [];\r\n\r\n    if (props.delegateUser !== null) {\r\n        \r\n        for (let i = 0; i < props.delegateUser.length; i++) {\r\n            allDeputys.push({\r\n                key: i,\r\n                name: props.delegateUser[i].surname + \", \" + props.delegateUser[i].givenName,\r\n                mail: props.delegateUser[i].mail,\r\n                businessTele: props.delegateUser[i].businessPhones[0],\r\n\r\n            })\r\n        }\r\n        \r\n        \r\n    }\r\n\r\n    const columns = [{\r\n        key: 'name',\r\n        name: 'Name',\r\n        className: '',\r\n        fieldName: 'name',\r\n        minWidth: 85,\r\n        maxWidth: 85,\r\n        onColumnClick: null,\r\n        isResizable: true,\r\n        isSorted: true,\r\n        data: 'string'\r\n    },\r\n    {\r\n        key: 'mail',\r\n        name: 'E-Mail Addresse',\r\n        className: '',\r\n        fieldName: 'mail',\r\n        minWidth: 145,\r\n        maxWidth: 145,\r\n        onColumnClick: null,\r\n        isResizable: true,\r\n        isSorted: true,\r\n        data: 'string'\r\n    },\r\n    {\r\n        key: 'businessTele',\r\n        name: 'Business Telephonnumber',\r\n        className: '',\r\n        fieldName: 'businessTele',\r\n        minWidth: 140,\r\n        maxWidth: 140,\r\n        onColumnClick: null,\r\n        isResizable: true,\r\n        isSorted: true,\r\n        data: 'string'\r\n    }]\r\n\r\n    const onItemInvoked = (item) => {\r\n        //TODO: ourDisplayName\r\n        props.deputyFound(item.name + \" \" + \"[\"+ item.mail + \"]\");\r\n   }\r\n    \r\n    let deputyList = (props.delegateUser !== null) ?\r\n\r\n        <DetailsList\r\n            items={allDeputys}\r\n            columns={columns}\r\n            setKey=\"set\"\r\n            layoutMode={DetailsListLayoutMode.justified}\r\n            selectionPreservedOnEmptyClick={true}\r\n            onItemInvoked={onItemInvoked}\r\n            selectionMode={SelectionMode.single}\r\n            \r\n        /> : null;   \r\n    \r\n    return (\r\n\r\n        <Aux>\r\n            {deputyList}\r\n        </Aux>\r\n    );\r\n\r\n\r\n}\r\n\r\nexport default DelegatesInformationList;","import { DefaultButton, Label, Panel, PanelType, PrimaryButton, Stack, TextField } from '@fluentui/react';\r\nimport React, { Component } from 'react';\r\n\r\nimport Aux from '../../hoc/Auxillary/Auxillary';\r\nimport DelegatesInformationList from './DeputysInformationList/DeputysInformationList';\r\n// import classes from './DelegateInformation.module.css';\r\n\r\nclass DeputyInformation extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            isDeputyPanelOpen: false,\r\n            deputyName: \"\",\r\n            deputyUser: null,\r\n            deputyFound: \"\",\r\n            finishedLoadingDeputy: false\r\n        }\r\n        this.deputySearchHandler = this.deputySearchHandler.bind(this);\r\n    }\r\n\r\n\r\n    deputyPanelHandler = () => {\r\n        this.setState((prevState) => {\r\n            return { isDeputyPanelOpen: !prevState.isDeputyPanelOpen }\r\n        })\r\n    }\r\n\r\n    searchFieldOnChangeHandler = (event) => {\r\n        let deputyName = { ...this.state.deputyName };\r\n\r\n        deputyName = event.target.value;\r\n\r\n        this.setState({ deputyName: deputyName });\r\n    }\r\n\r\n    deputySearchHandler = async (searchParameter) => {\r\n\r\n        let updatedDeputy = [];\r\n\r\n        ///https://graph.microsoft.com/v1.0/users?$filter=startswith(givenName,'Raphael') or startswith(mail,'r.') or startswith(surname,'lawo') or startswith(displayName,'Raphael') \r\n        let deputyContent = `https://graph.microsoft.com/v1.0/users?$filter=startswith(givenName,'${searchParameter}') or startswith(mail,'${searchParameter}') or startswith(surname,'${searchParameter}') or startswith(displayName,'${searchParameter}')`;\r\n        let graphRequestParams = {\r\n            method: 'GET',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                \"authorization\": \"bearer \" + this.props.graphAccessToken\r\n            }\r\n        }\r\n\r\n        let responseDeputy = await fetch(deputyContent, graphRequestParams).catch(this.unhandledFetchError);\r\n        let dataDeputy = await responseDeputy.json().catch(this.unhandledFetchError);\r\n\r\n\r\n\r\n        if (!responseDeputy.ok) {\r\n            console.log(dataDeputy);\r\n            this.setState({ error: true });\r\n        } else {\r\n            for (let i = 0; i < dataDeputy.value.length; i++) {\r\n                updatedDeputy.push(dataDeputy.value[i])\r\n            }\r\n            this.setState({\r\n                deputyUser: updatedDeputy,\r\n                finishedLoadingDeputy: true\r\n            })\r\n        }\r\n    }\r\n\r\n    deputyTextfieldReadOnlyHandler = (deputy) => {\r\n        this.setState({ deputyFound: deputy, isDeputyPanelOpen: false })\r\n        this.props.deputyHandler(deputy);\r\n    }\r\n\r\n\r\n    render() {\r\n        const selectDeputyDescription = (this.state.finishedLoadingDeputy) ?\r\n            <div>\r\n                For selecting a Deputy, double or select and press Enter!\r\n    </div> : null;\r\n\r\n        return (\r\n            <Aux>\r\n                <div>\r\n                    <Label >Deputy</Label>\r\n                </div>\r\n                <div>\r\n                    <Label>Please select the name of your deputy</Label>\r\n                </div>\r\n                <div>\r\n                    <div>\r\n                        <TextField readyOnly value={this.state.deputyFound} disabled/>\r\n                        <DefaultButton text=\"Deputy\" disabled={this.props.showDeputyButton} onClick={this.deputyPanelHandler} />\r\n                    </div>\r\n                </div>\r\n                <Panel\r\n                    isOpen={this.state.isDeputyPanelOpen}\r\n                    onDismiss={() => this.setState({ isDeputyPanelOpen: false })}\r\n                    type={PanelType.medium}\r\n                    closeButtonAriaLabel=\"Close\"\r\n                >\r\n                    <div>\r\n                        For a search enter givenName, sn, mail or displayName.\r\n                </div>\r\n                    <Stack horizontal tokens={aligmentsStackTokenSearch}>\r\n                        <Label><strong>Search:</strong></Label>\r\n                        <TextField onChange={this.searchFieldOnChangeHandler} />\r\n                        <PrimaryButton text=\"Start search...\" disabled={this.state.deputyName === \"\"} onClick={() => this.deputySearchHandler(this.state.deputyName)} />\r\n                    </Stack>\r\n                    <Stack tokens={aligmentsStackTokenSearch}>\r\n                        <DelegatesInformationList\r\n                            delegateUser={this.state.deputyUser}\r\n                            deputyFound={(deputy) => this.deputyTextfieldReadOnlyHandler(deputy)}\r\n                        />\r\n                        {selectDeputyDescription}\r\n                    </Stack>\r\n\r\n\r\n                </Panel>\r\n\r\n            </Aux>\r\n        )\r\n    }\r\n\r\n}\r\nconst aligmentsStackTokenSearch = {\r\n    childrenGap: 40,\r\n    padding: 25\r\n}\r\n\r\nexport default DeputyInformation;","import React, { useState } from 'react';\r\nimport classes from './AbsencePeriod.module.css';\r\n\r\nimport Aux from '../../hoc/Auxillary/Auxillary';\r\nimport { Checkbox, DatePicker, DayOfWeek, Label, Stack, Text } from '@fluentui/react';\r\nimport moment from 'moment';\r\nimport TimePicker from 'rc-time-picker';\r\n\r\n\r\n///Style change into to match fluenui Design\r\n/// border-radius: 2px\r\n/// border: 1px solid rgb(96, 94, 92);\r\nimport 'rc-time-picker/assets/index.css';\r\nconst AbsencePeriod = (props) => {\r\n    const [fromDate, setFromDate] = useState();\r\n    const [toDate, setToDate] = useState();\r\n    const [scheduledOOF, setScheduledOOF] = useState(Boolean);\r\n\r\n\r\n\r\n    const DayPickerString = {\r\n        months: [\r\n            'January',\r\n            'February',\r\n            'March',\r\n            'April',\r\n            'May',\r\n            'June',\r\n            'July',\r\n            'August',\r\n            'September',\r\n            'October',\r\n            'November',\r\n            'December'\r\n        ],\r\n        shortMonths: [\r\n            'Jan',\r\n            'Feb',\r\n            'Mar',\r\n            'Apr',\r\n            'Apr',\r\n            'May',\r\n            'Jun',\r\n            'Jul',\r\n            'Aug',\r\n            'Sep',\r\n            'Oct',\r\n            'Nov',\r\n            'Dec'\r\n        ],\r\n        days: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Firday', 'Saturday'],\r\n        shortDays: ['S', 'M', 'T', 'W', 'T', 'F', 'S'],\r\n        goToToday: 'Go to today',\r\n        prevMonthAriaLabel: 'Go to previous month',\r\n        nextMonthAriaLabel: 'Go to next month',\r\n        prevYearAriaLabel: 'Go to previous year',\r\n        nextYearAriaLabel: 'Go to next year',\r\n        closeButtonAriaLabel: 'Close date picker',\r\n        monthPickerHeaderAriaLabel: '{0}, select to change the year',\r\n        yearPickerHeaderAriaLabel: '{0}, select to change the month'\r\n    };\r\n\r\n    const fromSelectHandler = (fromDate) => {\r\n        setFromDate(fromDate);\r\n        props.fromDateHandler(fromDate);\r\n    }\r\n\r\n    const toSelectHandler = (toDate) => {\r\n        setToDate(toDate);\r\n        props.toDateHandler(toDate);\r\n    }\r\n\r\n    const onScheduledOOFChange = (ev, checked) => {\r\n        setScheduledOOF(checked);\r\n    }\r\n\r\n    const onFromTimeChange =(time) => {\r\n        if(time === null) {\r\n            props.fromTimeHandler(null);\r\n        }else {\r\n            props.fromTimeHandler(moment(time._d, 'HH:mm'));\r\n        }\r\n    }\r\n\r\n    const onToTimeChange = (time) => {\r\n        if(time === null) {\r\n            props.toTimeHandler(null);\r\n        }else {\r\n            props.toTimeHandler(moment(time._d, 'HH:mm'));\r\n        }\r\n    }\r\n\r\n    return (\r\n        <Aux>\r\n            <Stack >\r\n                <Stack tokens={aligmentsStackLabelTokens}>\r\n                    <Label>Absence period</Label>\r\n                    <Text>Please enter the period of your absence</Text>\r\n                    <Checkbox label=\"Scheduled Out of Office\" checked={scheduledOOF} onChange={onScheduledOOFChange}/>\r\n                </Stack>\r\n                <Stack horizontal tokens={aligmentsStackFromTokens}>\r\n                    <Label>from: </Label>\r\n                    <DatePicker\r\n                        id=\"fromDatePicker\"\r\n                        className={classes.Control}\r\n                        firstDayOfWeek={DayOfWeek.Monday}\r\n                        string={DayPickerString}\r\n                        showWeekNumbers={true}\r\n                        firstWeekOfYear={1}\r\n                        showMonthPickerAsOverlay={true}\r\n                        isRequired={true}\r\n                        value={fromDate}\r\n                        placeholder=\"Select a date...\"\r\n                        ariaLabel=\"Select a date\"\r\n                        onSelectDate={fromSelectHandler}\r\n                    />\r\n                    <TimePicker \r\n                    defaultValue={moment('08:00', 'HH:mm')} \r\n                    showSecond={false} minuteStep={15} \r\n                    disabled={!scheduledOOF}\r\n                    onChange={onFromTimeChange}\r\n                    />\r\n                </Stack>\r\n                <Stack horizontal tokens={aligmentsStackToTokens} style={{paddingLeft: '40px'}}>\r\n                    <Label>to: </Label>\r\n                    <DatePicker\r\n                        id=\"toDatePicker\"\r\n                        className={classes.Control}\r\n                        firstDayOfWeek={DayOfWeek.Monday}\r\n                        string={DayPickerString}\r\n                        showWeekNumbers={true}\r\n                        firstWeekOfYear={1}\r\n                        showMonthPickerAsOverlay={true}\r\n                        isRequired={true}\r\n                        value={toDate}\r\n                        onSelectDate={toSelectHandler}\r\n                        placeholder=\"Select a date...\"\r\n                        ariaLabel=\"Select a date\"\r\n                    />\r\n                    <TimePicker \r\n                    defaultValue={moment('18:00', 'HH:mm')} \r\n                    showSecond={false} \r\n                    minuteStep={15} \r\n                    disabled={!scheduledOOF}\r\n                    onChange={onToTimeChange}\r\n                    \r\n                    />\r\n\r\n                </Stack>\r\n            </Stack>\r\n\r\n\r\n        </Aux>\r\n    );\r\n}\r\n\r\nconst aligmentsStackFromTokens = {\r\n    childrenGap: 40,\r\n    padding: 25\r\n}\r\n\r\nconst aligmentsStackToTokens = {\r\n    childrenGap: 40\r\n}\r\n\r\nconst aligmentsStackLabelTokens = {\r\n    childrenGap: 20,\r\n    padding: 25\r\n}\r\n\r\n\r\nexport default AbsencePeriod;","import { Dropdown, Label } from '@fluentui/react';\r\nimport React from 'react';\r\n\r\nimport Aux from '../../hoc/Auxillary/Auxillary';\r\nconst AbsenceReason = (props) => {\r\n\r\n    return(\r\n        <Aux>\r\n            <Label>Reason of absence</Label>\r\n            Please select the reason of your absence\r\n            <Dropdown\r\n            \r\n            />\r\n        </Aux>\r\n    );\r\n}\r\n\r\nexport default AbsenceReason;","// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n\r\nimport React from 'react';\r\n// import { ChoiceGroup } from 'office-ui-fabric-react/lib/ChoiceGroup';\r\n// import axios from 'axios';\r\nimport * as microsoftTeams from \"@microsoft/teams-js\";\r\n\r\n\r\n// import DatePane from './DatePane/DatePane';\r\n// import Aux from '../hoc/Auxillary/Auxillary';\r\n// import classes from './Tab.module.css';\r\n// import { Checkbox, Stack, themeRulesStandardCreator } from '@fluentui/react';\r\nimport UserInformation from './UserInformation/UserInformation';\r\nimport { Loader } from '@fluentui/react-northstar'\r\nimport CIUser from '../classes/CIUser';\r\nimport DeputyInformation from './DeputyInformation/DeputyInformation';\r\nimport AbsencePeriod from './AbsencePeriod/AbsencePeriod';\r\nimport Aux from '../hoc/Auxillary/Auxillary';\r\nimport { PrimaryButton } from '@fluentui/react';\r\nimport AbsenceReason from './AbsenceReason/AbsenceReason';\r\nimport moment from 'moment';\r\n\r\n\r\n\r\n\r\n/**\r\n * The 'PersonalTab' component renders the main tab content\r\n * of your app.\r\n */\r\nclass OoFTeams extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      context: {},\r\n      ssoToken: \"\",\r\n      name: \"\",\r\n      givenName: \"\",\r\n      family_name: \"\",\r\n      aadObjectId: \"\",\r\n      upn: \"\",\r\n      graphAccessToken: \"\",\r\n      error: false,\r\n      loggedInUser: null,\r\n      deputy: null,\r\n      isOutofOffice: \"\",\r\n      fromDate: null,\r\n      fromTime: null,\r\n      toDate: null,\r\n      toTime: null,\r\n      submitButtonDisabled: true,\r\n      consentRequired: false,\r\n      consentProvided: false\r\n\r\n\r\n    }\r\n\r\n    this.unhandledFetchError = this.unhandledFetchError.bind(this);\r\n    this.ssoLoginSuccess = this.ssoLoginSuccess.bind(this);\r\n    this.ssoLoginFailure = this.ssoLoginFailure.bind(this);\r\n    this.consentSuccess = this.consentSuccess.bind(this);\r\n    this.consentFailure = this.consentFailure.bind(this);\r\n    this.unhandledFetchError = this.unhandledFetchError.bind(this);\r\n    this.callGraphFromClient = this.callGraphFromClient.bind(this);\r\n    this.showConsentDialog = this.showConsentDialog.bind(this);\r\n    this.exchangeClientTokenForServerToken = this.exchangeClientTokenForServerToken.bind(this);\r\n    this.requestUserInformations = this.requestUserInformations.bind(this);\r\n  }\r\n\r\n  //React lifecycle method that gets called once a component has finished mounting\r\n  //Learn more: https://reactjs.org/docs/react-component.html#componentdidmount\r\n  componentDidMount() {\r\n    microsoftTeams.initialize();\r\n\r\n    // Get the user context from Teams and set it in the state\r\n    microsoftTeams.getContext((context, error) => {\r\n      this.setState({ context: context });\r\n\r\n\r\n      // if (this.state.customerBookings === null) {\r\n      //   const requestData = {\r\n      //     \"webcode\": \"ciazure\",\r\n      //     \"sEmail\": username,\r\n      //     \"language\": \"en\"\r\n      //   }\r\n      //   axios.post(\"https://cloud.ci-solution.com/api/GetCustomerBookings\", requestData)\r\n      //     .then(response => {\r\n      //       this.setState({ customerBookings: response.data })\r\n      //     })\r\n      // }\r\n\r\n    });\r\n\r\n    let authenTokenRequestsOptions = {\r\n      successCallback: (result) => this.ssoLoginSuccess(result),\r\n      failureCallBack: (error) => this.ssoLoginFailure(error)\r\n    };\r\n\r\n    microsoftTeams.authentication.getAuthToken(authenTokenRequestsOptions);\r\n\r\n  }\r\n\r\n  ssoLoginSuccess = async (token) => {\r\n    this.setState({ ssoToken: token });\r\n\r\n    this.exchangeClientTokenForServerToken(token);\r\n  }\r\n\r\n\r\n\r\n  ssoLoginFailure(error) {\r\n    console.error(\"SSO failed: \", error);\r\n    this.setState({ error: true });\r\n  }\r\n\r\n  exchangeClientTokenForServerToken = async (token) => {\r\n    const ApiData = {\r\n      \"webcode\": \"ciazure\",\r\n      \"sEmail\": this.state.context[\"upn\"],\r\n      \"language\": \"en\"\r\n    }\r\n\r\n    ///https://cloud.ci-solution.com/api/GetMSGraphAccessToken\r\n    let response = await fetch('https://localhost:44381/api/GetMSGraphAccessToken', {\r\n      method: \"POST\",\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(ApiData)\r\n    })\r\n      .catch(this.unhandledFetchError); //This calls getGraphAccessToken route in /api-server/app.js\r\n    let data = await response.json().catch(this.unhandledFetchError);\r\n\r\n    //TODO: response.ok wieder einfÃ¼gen\r\n    if (!response.ok) {\r\n      console.log(data);\r\n      this.setState({ error: true });\r\n    } else {\r\n      this.setState({ graphAccessToken: data['access_token'] });\r\n      this.requestUserInformations(data[\"access_token\"])\r\n    }\r\n  }\r\n\r\n  requestUserInformations = async (accessToken) => {\r\n    let upn = this.state.context[\"upn\"];\r\n    let userContent = `https://graph.microsoft.com/v1.0/users/${upn}`\r\n\r\n    let graphRequestParams = {\r\n      method: 'GET',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        \"authorization\": \"bearer \" + this.state.graphAccessToken\r\n      }\r\n    }\r\n\r\n    let responseUser = await fetch(userContent, graphRequestParams).catch(this.unhandledFetchError);\r\n    let dataUser = await responseUser.json().catch(this.unhandledFetchError);\r\n\r\n\r\n\r\n    if (!responseUser.ok) {\r\n      console.log(dataUser);\r\n      this.setState({ error: true });\r\n    } else {\r\n      const cCIUser = new CIUser(dataUser);\r\n      this.setState({\r\n        loggedInUser: cCIUser\r\n      })\r\n    }\r\n  }\r\n\r\n\r\n  showConsentDialog() {\r\n    microsoftTeams.authentication.authenticate({\r\n      url: window.location.origin + \"/auth-start\",\r\n      width: 600,\r\n      height: 535,\r\n      successCallback: (result) => { this.consentSuccess(result) },\r\n      failureCallback: (reason) => { this.consentFailure(reason) }\r\n    });\r\n  }\r\n\r\n  consentSuccess(result) {\r\n    this.setState({\r\n      graphAccessToken: result,\r\n      consentProvided: true\r\n    });\r\n  }\r\n\r\n  consentFailure(reason) {\r\n    console.error(\"Consent failed: \", reason);\r\n    this.setState({ error: true });\r\n  }\r\n\r\n\r\n  callGraphFromClient = async () => {\r\n    let upn = this.state.context[\"upn\"];\r\n    if (upn === \"r.lawo@dokmgm.de\") {\r\n      upn = \"m.buettner@dokmgm.de\";\r\n    }\r\n    let graphPhotoEndpoint = `https://graph.microsoft.com/v1.0/users/${upn}/photo/$value`;\r\n    let graphRequestParams = {\r\n      method: 'GET',\r\n      headers: {\r\n        'Content-Type': 'image/jpg',\r\n        \"authorization\": \"bearer \" + this.state.graphAccessToken\r\n      }\r\n    }\r\n\r\n    let response = await fetch(graphPhotoEndpoint, graphRequestParams).catch(this.unhandledFetchError);\r\n    if (!response.ok) {\r\n      console.error(\"ERROR: \", response);\r\n      this.setState({ error: true });\r\n    }\r\n\r\n    let imageBlog = await response.blob().catch(this.unhandledFetchError);\r\n\r\n    this.setState({\r\n      photo: URL.createObjectURL(imageBlog)\r\n    })\r\n  }\r\n\r\n  unhandledFetchError(error) {\r\n    console.error(\"Unhandled fetch error: \", error);\r\n    this.setState({ error: true });\r\n  }\r\n\r\n\r\n\r\n  onChangeStatusHandler = (ev, checked) => {\r\n    this.setState({ isOutofOffice: checked.key });\r\n  }\r\n\r\n  fromDateHandler = (fromDate) => {\r\n    this.setState({\r\n      fromDate: fromDate\r\n    })\r\n  }\r\n\r\n  toDateHandler = (toDate) => {\r\n    this.setState({\r\n      toDate: toDate\r\n    })\r\n  }\r\n\r\n  fromTimeHandler = (fromTime) => {\r\n    this.setState({\r\n      fromTime: moment(fromTime._d, 'HH:mm')\r\n    });\r\n  }\r\n\r\n  toTimeHandler = (toTime) => {\r\n    this.setState({\r\n      toTime: moment(toTime, 'HH:mm')\r\n    });\r\n  }\r\n\r\n  submitOOF = () => {\r\n    console.log(\"From date: \", this.state.fromDate);\r\n    console.log(\"To date: \", this.state.toDate);\r\n  }\r\n\r\n  deputyFoundHandler = (deputyFound) => {\r\n    this.setState({\r\n      deputy: deputyFound\r\n    })\r\n\r\n\r\n  }\r\n\r\n  render() {\r\n    const oofStatus = [\r\n      { key: 'A', text: 'In Office', checked: true },\r\n      { key: 'B', text: 'Out of Office' }\r\n    ];\r\n\r\n    let title = Object.keys(this.state.context).length > 0 ?\r\n      'Congratulations ' + this.state.context[\"upn\"] + '! This is your tab!!!' : <Loader />\r\n\r\n\r\n    let serverExchangeMessage = (this.state.ssoToken === \"\") ?\r\n      <Loader label='Exchanging SSO access token for Graph access token...' /> : null;\r\n\r\n    // let constentButton = (this.state.consentRequired && !this.state.consentProvided) ?\r\n    //   <Loader label=\"Constent required\" onClick={this.showConsentDialog} /> : null;\r\n\r\n\r\n    let userInformations = (this.state.loggedInUser !== null) ?\r\n      <Aux>\r\n        <UserInformation\r\n          givenName={this.state.loggedInUser.givenName}\r\n          sn={this.state.loggedInUser.sn}\r\n          email={this.state.loggedInUser.email}\r\n          onChangeStatus={(ev, checked) => this.onChangeStatusHandler(ev, checked)}\r\n          oofStatus={oofStatus}\r\n        />\r\n        <AbsencePeriod\r\n          fromDateHandler={(fromDate) => this.fromDateHandler(fromDate)}\r\n          toDateHandler={(toDate) => this.toDateHandler(toDate)} \r\n          fromTimeHandler={(fromTime) => this.fromTimeHandler(fromTime)}\r\n          toTimeHandler={(toTime) => this.toTimeHandler(toTime)}/>\r\n      </Aux> : null;\r\n\r\n    let delegateInformations = (this.state.loggedInUser !== null && this.state.fromDate !== null && this.state.toDate !== null) ?\r\n      <DeputyInformation\r\n        graphAccessToken={this.state.graphAccessToken}\r\n        deputyHandler={(deputyFound) => this.deputyFoundHandler(deputyFound)}\r\n        showDeputyButton={!(this.state.fromDate !== null && this.state.toDate !== null)}\r\n      /> : null;\r\n\r\n    let absenceReason = (this.state.fromDate !== null && this.state.toDate !== null) ?\r\n      <AbsenceReason /> : null;\r\n\r\n    let error = (this.state.error) ? <h1>ERROR</h1> : null;\r\n\r\n    let submitButton = (this.state.loggedInUser !== null) ? \r\n    <PrimaryButton\r\n            text=\"Submit\"\r\n            disabled={!(this.state.fromDate !== null && this.state.toDate !== null && this.state.deputy !== null)}\r\n            onClick={this.submitOOF} /> : null;\r\n\r\n\r\n    // let content;\r\n    // if (this.state.error) {\r\n    //   content = <h1>ERROR</h1>\r\n    // } else {\r\n    //   content =\r\n    //     <div >\r\n    //       <h1>{title}</h1>\r\n    //       <h3>{ssoMessage}</h3>\r\n    //       <h3>{ssoOutput}</h3>\r\n    //       {/* <h3>{serverExchangeMessage}</h3> */}\r\n    //       {delegateInformations}\r\n    //     </div>\r\n    // }  \r\n\r\n\r\n\r\n\r\n\r\n    return (\r\n      <Aux>\r\n        { error}\r\n        <div>\r\n          {title}\r\n          {serverExchangeMessage}\r\n          {userInformations}\r\n          {absenceReason}\r\n          {delegateInformations}\r\n          {submitButton}\r\n\r\n        </div>\r\n      </Aux>\r\n    );\r\n\r\n\r\n\r\n\r\n    // let username = Object.keys(this.state.context).length > 0 ? this.state.context[\"upn\"] : \"\";\r\n\r\n    // const registerdOptions = [\r\n    //   {key: 'A', text: 'In Office', checked: true },\r\n    //   {key: 'B', text: 'Out of Office' }\r\n    // ];\r\n\r\n    // if (this.state.customerBookings) {\r\n    //   registerdOptions[0].checked = this.state.customerBookings.hasCIOof;\r\n    // }\r\n\r\n    // const onChange = (event, checked) => {\r\n    //   this.setState({ scheduledOOF: !!checked });\r\n    // }\r\n\r\n\r\n    //return (\r\n\r\n\r\n    // <div>\r\n    //   <h3>Hello World!</h3>\r\n    //   <h1>Congratulations {userName}!</h1> <h3>This is the tab you made :-)</h3>\r\n    //   <ChoiceGroup options={registerdOptions} label=\"Registered State\" />\r\n\r\n    // </div>\r\n    //   <Aux>\r\n    //     <Stack >\r\n    //       <Stack.Item align=\"center\">\r\n    //         <h1 style={{ textAlign: \"center\" }}>Welcome {username}</h1>\r\n    //       </Stack.Item>\r\n    //     </Stack>\r\n    //     <Stack horizontal disableShrink tokens={aligmentsStackTokensTop}>\r\n    //       <Stack.Item align=\"start\">\r\n    //         <DatePane />\r\n    //       </Stack.Item>\r\n    //       <Stack.Item align=\"start\">\r\n    //         <ChoiceGroup options={registerdOptions} label=\"Registered State\" />\r\n    //         <Checkbox className={classes.CheckboxOOF} label=\"Scheduled out of office\" checked={this.state.scheduledOOF} onChange={onChange} />\r\n    //       </Stack.Item>\r\n    //     </Stack>\r\n    //     <Stack>\r\n    //       <Stack.Item align=\"center\" tokens={aligmentsStackTokens}>\r\n    //         <AppointmentList />\r\n    //       </Stack.Item>\r\n    //     </Stack>\r\n    //   </Aux>\r\n    // );\r\n  }\r\n}\r\n\r\n// const aligmentsStackTokens = {\r\n//   childrenGap: 5,\r\n//   padding: 10,\r\n// };\r\n\r\n// const aligmentsStackTokensTop = {\r\n//   childrenGap: 40,\r\n//   padding: 25\r\n// }\r\nexport default OoFTeams;","// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n\r\nimport React from 'react';\r\n\r\nimport crypto from 'crypto';\r\nimport * as microsoftTeams from \"@microsoft/teams-js\";\r\n\r\n/**\r\n * This component is used to redirect the user to the Azure authorization endpoint from a popup\r\n */\r\nclass ConsentPopup extends React.Component {\r\n\r\n    componentDidMount() {\r\n\r\n      // Initialize the Microsoft Teams SDK\r\n      microsoftTeams.initialize();\r\n\r\n      // Get the user context in order to extract the tenant ID\r\n      microsoftTeams.getContext((context, error) => {\r\n\r\n        let tenant = context['tid']; //Tenant ID of the logged in user\r\n        let client_id = process.env.REACT_APP_AZURE_APP_REGISTRATION_ID; //Client ID of the Azure AD app registration ( may be from different tenant for multitenant apps)\r\n        let graph_scopes = process.env.REACT_APP_GRAPH_SCOPES;\r\n\r\n        //Form a query for the Azure implicit grant authorization flow\r\n        //https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-implicit-grant-flow      \r\n        let queryParams = {\r\n            tenant: `${tenant}`,\r\n            client_id: `${client_id}`,\r\n            response_type: \"token\", //token_id in other samples is only needed if using open ID\r\n            scope: `https://graph.microsoft.com/${graph_scopes}`,\r\n            redirect_uri: window.location.origin + \"/auth-end\",\r\n            nonce: crypto.randomBytes(16).toString('base64')\r\n        }\r\n        console.log(\"queryParams: \",queryParams);\r\n        let url = `https://login.microsoftonline.com/${tenant}/oauth2/v2.0/authorize?`;\r\n        queryParams = new URLSearchParams(queryParams).toString();\r\n        let authorizeEndpoint = url + queryParams;\r\n        \r\n        //Redirect to the Azure authorization endpoint. When that flow completes, the user will be directed to auth-end\r\n        //Go to ClosePopup.js\r\n        window.location.assign(authorizeEndpoint);\r\n\r\n      });\r\n    \r\n    }    \r\n\r\n    render() {\r\n      return (\r\n        <div>\r\n          <h1>Redirecting to consent page...</h1>\r\n        </div>\r\n      );\r\n    }\r\n}\r\n\r\nexport default ConsentPopup;","// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n\r\nimport React from 'react';\r\nimport './App.css';\r\nimport * as microsoftTeams from \"@microsoft/teams-js\";\r\n\r\n/**\r\n * This component is loaded when the Azure implicit grant flow has completed.\r\n */\r\nclass ClosePopup extends React.Component {\r\n\r\n    componentDidMount(){\r\n\r\n      microsoftTeams.initialize();\r\n\r\n      //The Azure implicit grant flow injects the result into the window.location.hash object. Parse it to find the results.\r\n      let hashParams = this.getHashParameters();\r\n\r\n      //If consent has been successfully granted, the Graph access token should be present as a field in the dictionary.\r\n      if (hashParams[\"access_token\"]){\r\n        //Notifify the showConsentDialogue function in Tab.js that authorization succeeded. The success callback should fire. \r\n        microsoftTeams.authentication.notifySuccess(hashParams[\"access_token\"]);\r\n      } else {\r\n        microsoftTeams.authentication.notifyFailure(\"Consent failed\");\r\n      }\r\n    }\r\n\r\n    //Helper function that converts window.location.hash into a dictionary\r\n    getHashParameters() {\r\n      let hashParams = {};\r\n      window.location.hash.substr(1).split(\"&\").forEach(function(item) {\r\n        let [key,value] = item.split('=');\r\n        hashParams[key] = decodeURIComponent(value);\r\n      });\r\n      return hashParams;\r\n  }    \r\n\r\n    render() {\r\n      return (\r\n        <div>\r\n          <h1>Consent flow complete.</h1>\r\n        </div>\r\n      );\r\n    }\r\n}\r\n\r\nexport default ClosePopup;","// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\n\r\nimport React from 'react';\r\nimport * as microsoftTeams from \"@microsoft/teams-js\";\r\nimport { HashRouter, Route } from \"react-router-dom\";\r\n\r\nimport Privacy from \"./Privacy\";\r\nimport TermsOfUse from \"./TermsOfUse\";\r\nimport OoFTeams from \"./OoFTeams\";\r\nimport ConsentPopup from \"./ConsentPopup\";\r\nimport ClosePopup from \"./ClosePopup\";\r\n\r\nimport { initializeIcons } from '@fluentui/react';\r\n\r\n\r\ninitializeIcons();\r\n/**\r\n * The main app which handles the initialization and routing\r\n * of the app.\r\n */\r\nfunction App() {\r\n\r\n  // Initialize the Microsoft Teams SDK\r\n  microsoftTeams.initialize();\r\n  console.log(\"this is the process.env\", process.env.PUBLIC_URL);\r\n\r\n  // Display the app home page hosted in Teams\r\n  return (\r\n    <>\r\n      <Route exact path=\"/privacy\" component={Privacy} />\r\n      <Route exact path=\"/termsofuse\" component={TermsOfUse} />\r\n      <Route exact path=\"/auth-start\" component={ConsentPopup} />\r\n      <Route exact path=\"/auth-end\" component={ClosePopup} />\r\n      <Route exact path=\"/oofteams\" component={OoFTeams} />\r\n      <Route exact path=\"/\" component={OoFTeams} />\r\n    </>\r\n  );\r\n\r\n};\r\n\r\nexport default App;\r\n","// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\nimport 'react-app-polyfill/ie9';\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './components/App';\r\nimport { Provider, themes } from '@fluentui/react-northstar' //https://fluentsite.z22.web.core.windows.net/quick-start\r\nimport { BrowserRouter } from 'react-router-dom';\r\n\r\nReactDOM.render(\r\n    <BrowserRouter basename={process.env.PUBLIC_URL}>\r\n        <Provider theme={themes.teams}>\r\n            <App />\r\n        </Provider>\r\n    </BrowserRouter>\r\n    , document.getElementById('root')\r\n);\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"Control\":\"AbsencePeriod_Control__2A9JG\"};"],"sourceRoot":""}