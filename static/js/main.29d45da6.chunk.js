(this["webpackJsonpmicrosoft-teams-ext"]=this["webpackJsonpmicrosoft-teams-ext"]||[]).push([[0],{1008:function(e,t){},1011:function(e,t){},1027:function(e,t){},1030:function(e,t){},1033:function(e,t,n){},1051:function(e,t,n){"use strict";n.r(t);n(687);var a=n(0),r=n.n(a),o=n(29),l=n.n(o),s=n(83),c=n(639),i=n(49),u=n(77),d=n(78),m=n(104),h=n(103),f=function(e){Object(m.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Privacy Statement"))}}]),n}(r.a.Component),p=function(e){Object(m.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Terms of Use"))}}]),n}(r.a.Component),b=n(105),y=n.n(b),g=n(176),v=n(72),E=function(e){return e.children},k=n(1150),O=n(1144),S=function(e){return r.a.createElement(E,null,r.a.createElement("div",null,r.a.createElement(k.a,null,"Current User")),r.a.createElement("div",null,r.a.createElement(k.a,null,"Information about current user")),r.a.createElement("div",null,"First name: ",r.a.createElement("span",null,r.a.createElement("strong",null,e.givenName)),r.a.createElement("br",null),"Last name: ",r.a.createElement("span",null,r.a.createElement("strong",null,e.sn)),r.a.createElement("br",null),"Email: ",r.a.createElement("span",null,r.a.createElement("strong",null,e.email))),r.a.createElement("div",null,r.a.createElement(O.a,{options:e.oofStatus,onChange:e.onChangeStatus})))},j=n(100),C=function(){function e(t){Object(u.a)(this,e),this.givenName=t.givenName,this.sn=t.surname,this.title=t.jobTitle,this.email=t.mail,this.telephoneNumber="",null!==this.email&&""!==this.email&&(this.login=this.email)}return Object(d.a)(e,[{key:"givenName",value:function(){return this.givenName}},{key:"sn",value:function(){return this.sn}},{key:"title",value:function(){return this.title}},{key:"email",value:function(){return this.email}},{key:"telephoneNumber",value:function(){return this.telephoneNumber}},{key:"login",value:function(){return this.login}}]),e}(),T=n(658),D=n(1147),x=n(657),H=n(1143),F=n(56),w=n(1148),N=n(1132),U=n(1137),A=n(38),P=n(108),L=function(e){var t=[];if(null!==e.delegateUser)for(var n=0;n<e.delegateUser.length;n++)t.push({key:n,name:e.delegateUser[n].surname+", "+e.delegateUser[n].givenName,mail:e.delegateUser[n].mail,businessTele:e.delegateUser[n].businessPhones[0]});var a=null!==e.delegateUser?r.a.createElement(U.a,{items:t,columns:[{key:"name",name:"Name",className:"",fieldName:"name",minWidth:85,maxWidth:85,onColumnClick:null,isResizable:!0,isSorted:!0,data:"string"},{key:"mail",name:"E-Mail Addresse",className:"",fieldName:"mail",minWidth:145,maxWidth:145,onColumnClick:null,isResizable:!0,isSorted:!0,data:"string"},{key:"businessTele",name:"Business Telephonnumber",className:"",fieldName:"businessTele",minWidth:140,maxWidth:140,onColumnClick:null,isResizable:!0,isSorted:!0,data:"string"}],setKey:"set",layoutMode:A.e.justified,selectionPreservedOnEmptyClick:!0,onItemInvoked:function(t){e.deputyFound(t.name+" ["+t.mail+"]")},selectionMode:P.b.single}):null;return r.a.createElement(E,null,a)},R=function(e){Object(m.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).deputyPanelHandler=function(){a.setState((function(e){return{isDeputyPanelOpen:!e.isDeputyPanelOpen}}))},a.searchFieldOnChangeHandler=function(e){var t=Object(T.a)({},a.state.deputyName);t=e.target.value,a.setState({deputyName:t})},a.deputySearchHandler=function(){var e=Object(g.a)(y.a.mark((function e(t){var n,r,o,l,s,c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],r="https://graph.microsoft.com/v1.0/users?$filter=startswith(givenName,'".concat(t,"') or startswith(mail,'").concat(t,"') or startswith(surname,'").concat(t,"') or startswith(displayName,'").concat(t,"')"),o={method:"GET",headers:{"Content-Type":"application/json",authorization:"bearer "+a.props.graphAccessToken}},e.next=5,fetch(r,o).catch(a.unhandledFetchError);case 5:return l=e.sent,e.next=8,l.json().catch(a.unhandledFetchError);case 8:if(s=e.sent,l.ok){for(c=0;c<s.value.length;c++)n.push(s.value[c]);a.setState({deputyUser:n,finishedLoadingDeputy:!0})}else console.log(s),a.setState({error:!0});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.deputyTextfieldReadOnlyHandler=function(e){a.setState({deputyFound:e,isDeputyPanelOpen:!1}),a.props.deputyHandler(e)},a.state={isDeputyPanelOpen:!1,deputyName:"",deputyUser:null,deputyFound:"",finishedLoadingDeputy:!1},a.deputySearchHandler=a.deputySearchHandler.bind(Object(v.a)(a)),a}return Object(d.a)(n,[{key:"render",value:function(){var e=this,t=this.state.finishedLoadingDeputy?r.a.createElement("div",null,"For selecting a Deputy, double or select and press Enter!"):null;return r.a.createElement(E,null,r.a.createElement("div",null,r.a.createElement(k.a,null,"Deputy")),r.a.createElement("div",null,r.a.createElement(k.a,null,"Please select the name of your deputy")),r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(D.a,{readyOnly:!0,value:this.state.deputyFound,disabled:!0}),r.a.createElement(x.a,{text:"Deputy",disabled:this.props.showDeputyButton,onClick:this.deputyPanelHandler}))),r.a.createElement(H.a,{isOpen:this.state.isDeputyPanelOpen,onDismiss:function(){return e.setState({isDeputyPanelOpen:!1})},type:F.a.medium,closeButtonAriaLabel:"Close"},r.a.createElement("div",null,"For a search enter givenName, sn, mail or displayName."),r.a.createElement(w.a,{horizontal:!0,tokens:M},r.a.createElement(k.a,null,r.a.createElement("strong",null,"Search:")),r.a.createElement(D.a,{onChange:this.searchFieldOnChangeHandler}),r.a.createElement(N.a,{text:"Start search...",disabled:""===this.state.deputyName,onClick:function(){return e.deputySearchHandler(e.state.deputyName)}})),r.a.createElement(w.a,{tokens:M},r.a.createElement(L,{delegateUser:this.state.deputyUser,deputyFound:function(t){return e.deputyTextfieldReadOnlyHandler(t)}}),t)))}}]),n}(a.Component),M={childrenGap:40,padding:25},G=R,I=n(226),z=n(461),W=n.n(z),_=n(1153),B=n(1154),J=n(1141),q=n(75),Y=n(70),V=n.n(Y),$=n(475),K=(n(828),{childrenGap:40,padding:25}),Q={childrenGap:40},X={childrenGap:20,padding:25},Z=function(e){var t=Object(a.useState)(),n=Object(I.a)(t,2),o=n[0],l=n[1],s=Object(a.useState)(),c=Object(I.a)(s,2),i=c[0],u=c[1],d=Object(a.useState)(Boolean),m=Object(I.a)(d,2),h=m[0],f=m[1],p={months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Firday","Saturday"],shortDays:["S","M","T","W","T","F","S"],goToToday:"Go to today",prevMonthAriaLabel:"Go to previous month",nextMonthAriaLabel:"Go to next month",prevYearAriaLabel:"Go to previous year",nextYearAriaLabel:"Go to next year",closeButtonAriaLabel:"Close date picker",monthPickerHeaderAriaLabel:"{0}, select to change the year",yearPickerHeaderAriaLabel:"{0}, select to change the month"};return r.a.createElement(E,null,r.a.createElement(w.a,null,r.a.createElement(w.a,{tokens:X},r.a.createElement(k.a,null,"Absence period"),r.a.createElement(_.a,null,"Please enter the period of your absence"),r.a.createElement(B.a,{label:"Scheduled Out of Office",checked:h,onChange:function(e,t){f(t)}})),r.a.createElement(w.a,{horizontal:!0,tokens:K},r.a.createElement(k.a,null,"from: "),r.a.createElement(J.a,{id:"fromDatePicker",className:W.a.Control,firstDayOfWeek:q.b.Monday,string:p,showWeekNumbers:!0,firstWeekOfYear:1,showMonthPickerAsOverlay:!0,isRequired:!0,value:o,placeholder:"Select a date...",ariaLabel:"Select a date",onSelectDate:function(t){l(t),e.fromDateHandler(t)}}),r.a.createElement($.a,{defaultValue:V()("08:00","HH:mm"),showSecond:!1,minuteStep:15,disabled:!h,onChange:function(t){null===t?e.fromTimeHandler(null):e.fromTimeHandler(V()(t._d,"HH:mm"))}})),r.a.createElement(w.a,{horizontal:!0,tokens:Q,style:{paddingLeft:"40px"}},r.a.createElement(k.a,null,"to: "),r.a.createElement(J.a,{id:"toDatePicker",className:W.a.Control,firstDayOfWeek:q.b.Monday,string:p,showWeekNumbers:!0,firstWeekOfYear:1,showMonthPickerAsOverlay:!0,isRequired:!0,value:i,onSelectDate:function(t){u(t),e.toDateHandler(t)},placeholder:"Select a date...",ariaLabel:"Select a date"}),r.a.createElement($.a,{defaultValue:V()("18:00","HH:mm"),showSecond:!1,minuteStep:15,disabled:!h,onChange:function(t){null===t?e.toTimeHandler(null):e.toTimeHandler(V()(t._d,"HH:mm"))}}))))},ee=n(1142),te=function(e){return r.a.createElement(E,null,r.a.createElement(k.a,null,"Reason of absence"),"Please select the reason of your absence",r.a.createElement(ee.a,null))},ne=function(e){Object(m.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).ssoLoginSuccess=function(){var e=Object(g.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({ssoToken:t}),a.exchangeClientTokenForServerToken(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.exchangeClientTokenForServerToken=function(){var e=Object(g.a)(y.a.mark((function e(t){var n,r,o;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={webcode:"ciazure",sEmail:a.state.context.upn,language:"en"},e.next=3,fetch("https://localhost:44381/api/GetMSGraphAccessToken",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).catch(a.unhandledFetchError);case 3:return r=e.sent,e.next=6,r.json().catch(a.unhandledFetchError);case 6:o=e.sent,r.ok?(a.setState({graphAccessToken:o.access_token}),a.requestUserInformations(o.access_token)):(console.log(o),a.setState({error:!0}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.requestUserInformations=function(){var e=Object(g.a)(y.a.mark((function e(t){var n,r,o,l,s,c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.state.context.upn,r="https://graph.microsoft.com/v1.0/users/".concat(n),o={method:"GET",headers:{"Content-Type":"application/json",authorization:"bearer "+a.state.graphAccessToken}},e.next=5,fetch(r,o).catch(a.unhandledFetchError);case 5:return l=e.sent,e.next=8,l.json().catch(a.unhandledFetchError);case 8:s=e.sent,l.ok?(c=new C(s),a.setState({loggedInUser:c})):(console.log(s),a.setState({error:!0}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.callGraphFromClient=Object(g.a)(y.a.mark((function e(){var t,n,r,o,l;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"r.lawo@dokmgm.de"===(t=a.state.context.upn)&&(t="m.buettner@dokmgm.de"),n="https://graph.microsoft.com/v1.0/users/".concat(t,"/photo/$value"),r={method:"GET",headers:{"Content-Type":"image/jpg",authorization:"bearer "+a.state.graphAccessToken}},e.next=6,fetch(n,r).catch(a.unhandledFetchError);case 6:return(o=e.sent).ok||(console.error("ERROR: ",o),a.setState({error:!0})),e.next=10,o.blob().catch(a.unhandledFetchError);case 10:l=e.sent,a.setState({photo:URL.createObjectURL(l)});case 12:case"end":return e.stop()}}),e)}))),a.onChangeStatusHandler=function(e,t){a.setState({isOutofOffice:t.key})},a.fromDateHandler=function(e){a.setState({fromDate:e})},a.toDateHandler=function(e){a.setState({toDate:e})},a.fromTimeHandler=function(e){a.setState({fromTime:V()(e._d,"HH:mm")})},a.toTimeHandler=function(e){a.setState({toTime:V()(e,"HH:mm")})},a.submitOOF=function(){console.log("From date: ",a.state.fromDate),console.log("To date: ",a.state.toDate)},a.deputyFoundHandler=function(e){a.setState({deputy:e})},a.state={context:{},ssoToken:"",name:"",givenName:"",family_name:"",aadObjectId:"",upn:"",graphAccessToken:"",error:!1,loggedInUser:null,deputy:null,isOutofOffice:"",fromDate:null,fromTime:null,toDate:null,toTime:null,submitButtonDisabled:!0,consentRequired:!1,consentProvided:!1},a.unhandledFetchError=a.unhandledFetchError.bind(Object(v.a)(a)),a.ssoLoginSuccess=a.ssoLoginSuccess.bind(Object(v.a)(a)),a.ssoLoginFailure=a.ssoLoginFailure.bind(Object(v.a)(a)),a.consentSuccess=a.consentSuccess.bind(Object(v.a)(a)),a.consentFailure=a.consentFailure.bind(Object(v.a)(a)),a.unhandledFetchError=a.unhandledFetchError.bind(Object(v.a)(a)),a.callGraphFromClient=a.callGraphFromClient.bind(Object(v.a)(a)),a.showConsentDialog=a.showConsentDialog.bind(Object(v.a)(a)),a.exchangeClientTokenForServerToken=a.exchangeClientTokenForServerToken.bind(Object(v.a)(a)),a.requestUserInformations=a.requestUserInformations.bind(Object(v.a)(a)),a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this;s.initialize(),s.getContext((function(t,n){e.setState({context:t})}));var t={successCallback:function(t){return e.ssoLoginSuccess(t)},failureCallBack:function(t){return e.ssoLoginFailure(t)}};s.authentication.getAuthToken(t)}},{key:"ssoLoginFailure",value:function(e){console.error("SSO failed: ",e),this.setState({error:!0})}},{key:"showConsentDialog",value:function(){var e=this;s.authentication.authenticate({url:window.location.origin+"/auth-start",width:600,height:535,successCallback:function(t){e.consentSuccess(t)},failureCallback:function(t){e.consentFailure(t)}})}},{key:"consentSuccess",value:function(e){this.setState({graphAccessToken:e,consentProvided:!0})}},{key:"consentFailure",value:function(e){console.error("Consent failed: ",e),this.setState({error:!0})}},{key:"unhandledFetchError",value:function(e){console.error("Unhandled fetch error: ",e),this.setState({error:!0})}},{key:"render",value:function(){var e=this,t=Object.keys(this.state.context).length>0?"Congratulations "+this.state.context.upn+"! This is your tab!!!":r.a.createElement(j.a,null),n=""===this.state.ssoToken?r.a.createElement(j.a,{label:"Exchanging SSO access token for Graph access token..."}):null,a=null!==this.state.loggedInUser?r.a.createElement(E,null,r.a.createElement(S,{givenName:this.state.loggedInUser.givenName,sn:this.state.loggedInUser.sn,email:this.state.loggedInUser.email,onChangeStatus:function(t,n){return e.onChangeStatusHandler(t,n)},oofStatus:[{key:"A",text:"In Office",checked:!0},{key:"B",text:"Out of Office"}]}),r.a.createElement(Z,{fromDateHandler:function(t){return e.fromDateHandler(t)},toDateHandler:function(t){return e.toDateHandler(t)},fromTimeHandler:function(t){return e.fromTimeHandler(t)},toTimeHandler:function(t){return e.toTimeHandler(t)}})):null,o=null!==this.state.loggedInUser&&null!==this.state.fromDate&&null!==this.state.toDate?r.a.createElement(G,{graphAccessToken:this.state.graphAccessToken,deputyHandler:function(t){return e.deputyFoundHandler(t)},showDeputyButton:!(null!==this.state.fromDate&&null!==this.state.toDate)}):null,l=null!==this.state.fromDate&&null!==this.state.toDate?r.a.createElement(te,null):null,s=this.state.error?r.a.createElement("h1",null,"ERROR"):null,c=null!==this.state.loggedInUser?r.a.createElement(N.a,{text:"Submit",disabled:!(null!==this.state.fromDate&&null!==this.state.toDate&&null!==this.state.deputy),onClick:this.submitOOF}):null;return r.a.createElement(E,null,s,r.a.createElement("div",null,t,n,a,l,o,c))}}]),n}(r.a.Component),ae=n(638),re=n.n(ae),oe=function(e){Object(m.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"componentDidMount",value:function(){s.initialize(),s.getContext((function(e,t){var n=e.tid,a={tenant:"".concat(n),client_id:"".concat("fc1e4e41-1e20-49ba-88aa-5f26fa8bc4da"),response_type:"token",scope:"https://graph.microsoft.com/".concat("User.Read"),redirect_uri:window.location.origin+"/auth-end",nonce:re.a.randomBytes(16).toString("base64")};console.log("queryParams: ",a);var r="https://login.microsoftonline.com/".concat(n,"/oauth2/v2.0/authorize?")+(a=new URLSearchParams(a).toString());window.location.assign(r)}))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Redirecting to consent page..."))}}]),n}(r.a.Component),le=(n(1033),function(e){Object(m.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"componentDidMount",value:function(){s.initialize();var e=this.getHashParameters();e.access_token?s.authentication.notifySuccess(e.access_token):s.authentication.notifyFailure("Consent failed")}},{key:"getHashParameters",value:function(){var e={};return window.location.hash.substr(1).split("&").forEach((function(t){var n=t.split("="),a=Object(I.a)(n,2),r=a[0],o=a[1];e[r]=decodeURIComponent(o)})),e}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Consent flow complete."))}}]),n}(r.a.Component)),se=n(1139);Object(se.a)();var ce=function(){return s.initialize(),r.a.createElement(c.a,{basename:"https://manbuettner.github.io"},r.a.createElement(i.c,null,r.a.createElement(i.a,{exact:!0,path:"/privacy",component:f}),r.a.createElement(i.a,{exact:!0,path:"/termsofuse",component:p}),r.a.createElement(i.a,{exact:!0,path:"/auth-start",component:oe}),r.a.createElement(i.a,{exact:!0,path:"/auth-end",component:le}),r.a.createElement(i.a,{exact:!0,path:"/oofteams",component:ne})))},ie=n(295),ue=n(456);l.a.render(r.a.createElement(ie.a,{theme:ue.themes.teams},r.a.createElement(ce,null)),document.getElementById("root"))},461:function(e,t,n){e.exports={Control:"AbsencePeriod_Control__2A9JG"}},686:function(e,t,n){e.exports=n(1051)},937:function(e,t){},939:function(e,t){},950:function(e,t){},952:function(e,t){},979:function(e,t){},981:function(e,t){},982:function(e,t){},988:function(e,t){},990:function(e,t){}},[[686,1,2]]]);
//# sourceMappingURL=main.29d45da6.chunk.js.map